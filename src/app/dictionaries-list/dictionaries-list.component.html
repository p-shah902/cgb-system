
<!-- Toasts Container -->
<div class="toast-container position-fixed top-0 end-0 p-3">
  <ngb-toast 
    *ngFor="let toast of toastService.toasts" 
    [class]="'bg-' + toast.type +' text-white'"
    [autohide]="true"
    [delay]="5000"
    (hidden)="toastService.remove(toast)"
  >
    {{ toast.message }}
  </ngb-toast>
</div>

<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <div class="page-card-div">
        <div class="form-header mb-4">
          <div class="row align-items-center">
            <div class="col-5">
              <div class="fh-title">
                <h3>List of Dictionaries</h3>
              </div>
            </div>
            <div class="col-7">
              <div class="filter-head d-flex justify-content-end gap-3 mb-4">
                <div class="fh-search">
                  <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M16 14H15.21L14.93 13.73C15.91 12.59 16.5 11.11 16.5 9.5C16.5 5.91 13.59 3 10 3C6.41 3 3.5 5.91 3.5 9.5C3.5 13.09 6.41 16 10 16C11.61 16 13.09 15.41 14.23 14.43L14.5 14.71V15.5L19.5 20.49L20.99 19L16 14ZM10 14C7.51 14 5.5 11.99 5.5 9.5C5.5 7.01 7.51 5 10 5C12.49 5 14.5 7.01 14.5 9.5C14.5 11.99 12.49 14 10 14Z"
                          fill="#84818A"/>
                  </svg>
                  <input class="form-control" 
                         placeholder="Search dictionary items..."
                         [(ngModel)]="searchText"
                         (input)="onSearchChange()"/>
                </div>
                <div class="role-btn-div text-end">
                  <button class="btn btn-light ms-auto" (click)="nevigate()">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M10.0001 4.16797V15.8346M4.16675 10.0013H15.8334" stroke="white" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Add New Dictionary
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="page-card-body">
          <div class="dictionaries-detail">
            <div class="d-flex">       
              <div ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-pills flex-column" orientation="vertical">
              <div *ngIf="dictionaryItem.length === 0" class="text-center py-5 px-3">
                <p class="text-muted mb-0" style="font-size: 16px; font-weight: 500;">No dictionary items found</p>
                <p class="text-muted mt-2" style="font-size: 14px;">Try adjusting your search criteria</p>
              </div>
              <ng-container *ngFor="let item of dictionaryItem;let i=index"> 
                <ng-container [ngbNavItem]="item.itemName">
                  <button ngbNavLink (click)="loadDictionaryDetails(item.itemName)">{{item.itemName}}</button>
                  <ng-template ngbNavContent>
                   <div class="dict-table-div">
                    <div *ngIf="isLoading" class="table-loader">
                      <div class="spinner"></div>
                      <p>Loading data, please wait...</p>
                    </div>
                     <table class="table" *ngIf="!isLoading">
                       <thead>
                         <tr>
                           <th>Value Name</th>
                           <th>Status</th>
                           <th>Last Updated</th>
                           <th>Action</th>
                         </tr>
                       </thead>
                       <tbody>
                        <tr *ngIf="dictionaryDetail.length === 0 && !isLoading">
                          <td [attr.colspan]="4" class="text-center py-5">
                            <div class="d-flex flex-column align-items-center justify-content-center">
                              <p class="text-muted mb-0" style="font-size: 16px; font-weight: 500;">No dictionary items found</p>
                              <p class="text-muted mt-2" style="font-size: 14px;">Try adjusting your search criteria</p>
                            </div>
                          </td>
                        </tr>
                        <tr *ngFor="let detail of dictionaryDetail">
                         <td>{{detail.itemValue}}</td>
                         <td>
                           <span [ngClass]="detail.isActive ? 'p-active' : 'p-inactive'">
                             {{ detail.isActive ? 'Active' : 'Inactive' }}
                           </span>
                         </td>
                         <td>{{ (detail.modifiedDate || detail.createdDate) | date: 'dd MMMM yyyy' }}</td>
                         <td>
                           <div class="edit-btn-div">
                             <a [routerLink]="['/dictionaries-edit', item.itemName,detail.id]" class="btn">
                               <svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                 <path d="M11.4174 1.52051L10.094 2.84395L13.6486 6.39863L14.9721 5.0752C15.6557 4.3916 15.6557 3.28418 14.9721 2.60059L13.8947 1.52051C13.2111 0.836914 12.1037 0.836914 11.4201 1.52051H11.4174ZM9.47598 3.46191L3.10215 9.83848C2.81778 10.1229 2.60997 10.4756 2.49512 10.8611L1.52715 14.1506C1.45879 14.383 1.52169 14.6318 1.69122 14.8014C1.86075 14.9709 2.10958 15.0338 2.33926 14.9682L5.62872 14.0002C6.01426 13.8854 6.367 13.6775 6.65137 13.3932L13.0307 7.0166L9.47598 3.46191Z" stroke="#626262" stroke-width="1.2"/>
                               </svg>
                             </a>
                           </div>
                         </td>
                       </tr>
                       </tbody>
                     </table>
                     
                     <!-- Pagination -->
                     <div class="pagination-wrapper mt-4" *ngIf="getTotalPages() > 0">
                       <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
                         <!-- Page Size Selector -->
                         <div class="d-flex align-items-center gap-2">
                           <label class="text-muted mb-0">Items per page:</label>
                           <select class="form-select form-select-sm" style="width: auto;" [(ngModel)]="itemsPerPage" (change)="onPageSizeChange()">
                             <option *ngFor="let size of pageSizeOptions" [value]="size">{{ size }}</option>
                           </select>
                         </div>
                         
                         <!-- Pagination Info -->
                         <div class="pagination-info">
                           <span class="text-muted">
                             Showing {{ getStartItem() }} - {{ getEndItem() }} of {{ totalItems }} items
                           </span>
                         </div>
                         
                         <!-- Pagination Controls -->
                         <div class="pagination-controls d-flex align-items-center gap-2">
                           <button class="btn btn-outline-secondary btn-sm"
                                   (click)="prevPage()"
                                   [disabled]="currentPage === 1">
                             <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                               <path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                             </svg>
                           </button>
                           <div class="d-flex gap-1">
                             <button *ngFor="let page of getPageNumbers()"
                                     class="btn btn-sm"
                                     [class.btn-primary]="page === currentPage"
                                     [class.btn-outline-secondary]="page !== currentPage"
                                     (click)="goToPage(page)">
                               {{ page }}
                             </button>
                           </div>
                           <button class="btn btn-outline-secondary btn-sm"
                                   (click)="nextPage()"
                                   [disabled]="currentPage === getTotalPages()">
                             <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                               <path d="M6 4L10 8L6 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                             </svg>
                           </button>
                         </div>
                       </div>
                     </div>
                   </div>
                  </ng-template>
                </ng-container>
              </ng-container>
              </div>

              <div [ngbNavOutlet]="nav" class="ms-4"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
